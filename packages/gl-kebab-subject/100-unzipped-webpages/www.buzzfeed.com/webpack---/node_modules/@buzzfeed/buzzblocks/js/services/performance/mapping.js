export const performanceMapPath = 'track/website/performance';
export const customMarkMapPath = 'track/website/custom_timers';

// Map for general website performance
export function performanceMap(mapper) {
    const performanceMapping = mapper.getOrCreateMap(performanceMapPath);

    performanceMapping.addMapTo('type', 'website_performance');
    performanceMapping.addMapTo('kind', 'performance');
    performanceMapping.addMapTo('page_type', '').mapFrom('data.page.type');
    performanceMapping.addMapTo('page_format', '').mapFrom('data.page.post.format.type');
    performanceMapping.addMapTo('buzz_id', '').mapFrom('data.page.post.id');
    performanceMapping.addMapTo('platform', '').mapFrom('data.page.platform');
    performanceMapping.addMapTo('be_tcp', '').mapFrom('data.connectTime');
    performanceMapping.addMapTo('be_dns', '').mapFrom('data.lookupDomainTime');
    performanceMapping.addMapTo('be_latency', '').mapFrom(function(src) {
        return src.data.responseEnd - src.data.fetchStart;
    });
    performanceMapping.addMapTo('be_time', '').mapFrom(function(src) {
        return src.data.responseStart - src.data.navigationStart;
    });
    performanceMapping.addMapTo('fe_firstpaint', '').mapFrom('data.firstPaintTime');
    performanceMapping.addMapTo('fe_page_load', '').mapFrom(function(src) {
        return src.data.loadEventEnd - src.data.responseEnd;
    });
    performanceMapping.addMapTo('fe_page_load_full', '').mapFrom(function(src) {
        return src.data.loadEventEnd - src.data.navigationStart;
    });
    performanceMapping.addMapTo('fe_time', '').mapFrom(function(src) {
        return src.data.loadEventEnd - src.data.responseStart;
    });
    performanceMapping.addMapTo('fe_dom_content_loaded', '').mapFrom(function(src) {
        return src.data.domContentLoadedEventStart - src.data.navigationStart;
    });

    return performanceMapping;
}

// Map for custom performance timers
export function customMarkMap(mapper) {
    const customMarkMapping = mapper.getOrCreateMap(customMarkMapPath);

    customMarkMapping.addMapTo('type', 'website_performance');
    customMarkMapping.addMapTo('kind', 'custom_timer');
    customMarkMapping.addMapTo('platform', '').mapFrom('data.page.platform');
    customMarkMapping.addMapTo('country', '').mapFrom('data.page.country');
    customMarkMapping.addMapTo('buzz_id', '').mapFrom('data.page.post.id');
    customMarkMapping.addMapTo('mark_name', '').mapFrom(`data.markName`);
    customMarkMapping.addMapTo('mark_value', '').mapFrom(`data.markValue`);

    return customMarkMapping;
}