import {
    Application
} from 't3js';
import ads from '../../core/ads';
import prepareTemplate from '@buzzfeed/buzzblocks/js/services/nunjucks-env';
import {
    AdNativeVideoFormat
} from '../../core';
import moduleTemplate from './index.html';
import cardHeaderTemplate from './partials/_header.html';
import cardFooterTemplate from './partials/_footer.html';


/**
 * DFP template: https://www.google.com/dfp/6556?#delivery/CreateNativeAdFormatAndStyle/nativeStyleId=122436&creativeTemplateId=11732990
 */

class AdStoryNativeVideo extends AdNativeVideoFormat {
    buildFormat() {
        const templateData = this.getTemplateData();
        // video is inside ad iframe
        const video = ads.getSlotContainer(this.config.wid);
        video.classList.add('xs-col-12');
        this.rootElement.classList.add('card');
        video.insertAdjacentHTML(
            'beforebegin', prepareTemplate(cardHeaderTemplate).render(templateData)
        );
        video.insertAdjacentHTML(
            'afterend', prepareTemplate(cardFooterTemplate).render(templateData)
        );
    }
}

AdStoryNativeVideo.moduleTemplate = moduleTemplate;

Application.addModule('ad-story-native-video', AdStoryNativeVideo.generateModule());

export {
    AdStoryNativeVideo
};