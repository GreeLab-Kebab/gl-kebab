(function() {
    var t = {}.hasOwnProperty;
    define("ophan/transmit", [], function() {
        var n, e, o, i, r, a, u, l, d, c, s, f;
        return o = function() {
            return (new Date).getTime().toString(36) + "xxxxxxxxxxxx".replace(/x/g, function() {
                return Math.floor(36 * Math.random()).toString(36)
            })
        }, d = null != (c = "undefined" != typeof guardian && null !== guardian && null != (s = guardian.config) && null != (f = s.ophan) ? f.pageViewId : void 0) ? c : o(), e = function() {
            return d = o()
        }, a = function(t) {
            return r("//ophan.theguardian.com/img/1?" + n(t))
        }, l = function(t) {
            return "string" == typeof t || "number" == typeof t ? encodeURIComponent(t) : encodeURIComponent(JSON.stringify(t))
        }, u = function(n, e) {
            var o, a, u;
            return JSON && (u = function() {
                var e;
                e = [];
                for (o in n) t.call(n, o) && (a = n[o], i(a) && e.push("" + encodeURIComponent(o) + "=" + l(a)));
                return e
            }(), u.length) ? r("//ophan.theguardian.com/img/2?viewId=" + d + "&" + u.join("&"), e) : void 0
        }, i = function(t) {
            return Array.isArray(t) ? t.length : null != t
        }, n = function(n) {
            var e, o, i;
            return n.viewId = d, i = function() {
                var i;
                i = [];
                for (e in n) t.call(n, e) && (o = n[e], null != o && i.push("" + encodeURIComponent(e) + "=" + encodeURIComponent(o)));
                return i
            }(), i.join("&")
        }, r = function(t, n) {
            var e, o;
            return o = new Image, e = setInterval(function() {
                return o.complete ? ("function" == typeof n && n(), clearInterval(e)) : void 0
            }, 10), o.src = t
        }, {
            sendInitial: a,
            sendMore: u,
            viewId: d,
            bumpViewId: e
        }
    })
}).call(this),
    function() {
        define("ophan/visibility", [], function() {
            return {
                state: function() {
                    return document.visibilityState || document.webkitVisibilityState || document.mozVisibilityState || document.msVisibilityState
                },
                changeEvent: document.visibilityState ? "visibilitychange" : document.webkitVisibilityState ? "webkitvisibilitychange" : document.mozVisibilityState ? "mozvisibilitychange" : document.msVisibilityState ? "msvisibilitychange" : void 0
            }
        })
    }.call(this),
    function() {
        define("ophan/vendor/adBlockDetectionLib", [], function() {
            var t = function() {
                function t(t) {
                    return "function" == typeof t
                }

                function n(t, n) {
                    var e, o, i = n,
                        r = document;
                    if (o = r.createElement(t), i)
                        for (e in i) i.hasOwnProperty(e) && o.setAttribute(e, i[e]);
                    return o
                }

                function e(t, n, e) {
                    v ? t.attachEvent("on" + n, e) : t.addEventListener(n, e, !1)
                }

                function o(t, n) {
                    (m.debug || n) && window.console && window.console.log && (n ? console.error("[ABD] " + t) : console.log("[ABD] " + t))
                }

                function i(t) {
                    o("start beginTest"), 1 != S && (h = !0, r(t), E.quick = "testing", k.test = setTimeout(function() {
                        a(t, 1)
                    }, 5))
                }

                function r(t) {
                    var e, i, r = document,
                        a = r.body,
                        u = "width: 1px !important; height: 1px !important; position: absolute !important; left: -10000px !important; top: -1000px !important;";
                    if (null == t || "string" == typeof t) return void o("invalid bait being cast");
                    for (null != t.style && (u += t.style), w = n("div", {
                            "class": t.cssClass,
                            style: u
                        }), o("adding bait node to DOM"), a.appendChild(w), e = 0; e < b.nullProps.length; e++) i = w[b.nullProps[e]];
                    for (e = 0; e < b.zeroProps.length; e++) i = w[b.zeroProps[e]]
                }

                function a(t, n) {
                    var e, i = document.body,
                        d = !1;
                    if (null == w && (o("recast bait"), r(t || y)), "string" == typeof t) return o("invalid bait used", !0), void(u() && setTimeout(function() {
                        h = !1
                    }, 5));
                    for (k.test > 0 && (clearTimeout(k.test), k.test = 0), null !== i.getAttribute("abp") && (o("found adblock body attribute"), d = !0), e = 0; e < b.nullProps.length; e++) {
                        if (null == w[b.nullProps[e]]) {
                            n > 4 && (d = !0), o("found adblock null attr: " + b.nullProps[e]);
                            break
                        }
                        if (1 == d) break
                    }
                    for (e = 0; e < b.zeroProps.length && 1 != d; e++) 0 == w[b.zeroProps[e]] && (n > 4 && (d = !0), o("found adblock zero attr: " + b.zeroProps[e]));
                    if (void 0 !== window.getComputedStyle) {
                        var c = window.getComputedStyle(w, null);
                        ("none" == c.getPropertyValue("display") || "hidden" == c.getPropertyValue("visibility")) && (n > 4 && (d = !0), o("found adblock computedStyle indicator"))
                    }
                    p = !0, d || n++ >= m.maxLoop ? (S = d, o("exiting test loop - value: " + S), l(), u() && setTimeout(function() {
                        h = !1
                    }, 5)) : k.test = setTimeout(function() {
                        a(t, n)
                    }, m.loopDelay)
                }

                function u() {
                    if (null === w) return !0;
                    try {
                        t(w.remove) && w.remove(), document.body.removeChild(w)
                    } catch (n) {}
                    return w = null, !0
                }

                function l() {
                    var n, e;
                    if (null !== S)
                        for (n = 0; n < g.length; n++) {
                            e = g[n];
                            try {
                                null != e && (t(e.complete) && e.complete(S), S && t(e.found) ? e.found() : S === !1 && t(e.notfound) && e.notfound())
                            } catch (i) {
                                o("Failure in notify listeners " + i.Message, !0)
                            }
                        }
                }

                function d() {
                    var t, n = !1;
                    document.readyState && "complete" == document.readyState && (n = !0), t = function() {
                        i(y, !1)
                    }, n ? t() : e(window, "load", t)
                }
                var c = "offset",
                    s = "client",
                    f = function() {},
                    p = !1,
                    h = !1,
                    v = void 0 === window.addEventListener,
                    m = {
                        loopDelay: 50,
                        maxLoop: 5,
                        debug: !1,
                        found: f,
                        notfound: f,
                        complete: f
                    },
                    g = [],
                    w = null,
                    y = {
                        cssClass: "ad-slot pub_300x250 pub_300x250m pub_728x90 text-ad textAd text_ad text_ads text-ads text-ad-links"
                    },
                    b = {
                        nullProps: [c + "Parent"],
                        zeroProps: []
                    };
                b.zeroProps = [c + "Height", c + "Left", c + "Top", c + "Width", c + "Height", s + "Height", s + "Width"];
                var E = {
                        quick: null,
                        remote: null
                    },
                    S = null,
                    k = {
                        test: 0,
                        download: 0
                    };
                return function(t) {
                    var n, e;
                    if (t) {
                        e = {
                            complete: f,
                            found: f,
                            notfound: f
                        };
                        for (n in t) t.hasOwnProperty(n) && ("complete" == n || "found" == n || "notFound" == n ? e[n.toLowerCase()] = t[n] : m[n] = t[n]);
                        g.push(e), d()
                    }
                }
            };
            return {
                init: t()
            }
        })
    }.call(this),
    function() {
        define("ophan/adblock-detection", ["ophan/vendor/adBlockDetectionLib"], function(t) {
            return {
                run: function() {
                    return new Promise(function(n, e) {
                        var o;
                        if (!t.init) return e(new Error("Failed to initialise adblock detection"));
                        try {
                            return t.init({
                                complete: function(t) {
                                    return n(t)
                                }
                            })
                        } catch (i) {
                            return o = i, e(o)
                        }
                    })
                }
            }
        })
    }.call(this),
    function() {
        var t = {}.hasOwnProperty;
        define("ophan/core", ["ophan/transmit", "ophan/visibility", "ophan/adblock-detection"], function(n, e, o) {
            var i, r, a, u, l, d, c, s, f, p, h, v;
            return i = 15, d = window.document, l = null != window.localStorage && "undefined" != typeof JSON && null !== JSON, p = null, c = function(t, n) {
                return p = t, "prerender" !== e.state() ? h(n) : e.changeEvent ? d.addEventListener(e.changeEvent, function() {
                    return "visible" === e.state() ? h(n) : void 0
                }, !1) : void 0
            }, h = function(t, l, d) {
                var c, s;
                return null == l && (l = location.href), null == d && (d = window.document.referrer), c = {
                    v: i,
                    platform: p,
                    url: l,
                    ref: d,
                    visibilityState: e.state(),
                    isModernBrowser: "undefined" != typeof guardian && null !== guardian ? guardian.isModernBrowser : void 0,
                    httpStatus: t,
                    tz: (new Date).getTimezoneOffset(),
                    kxkuid: null != (s = window.localStorage) && "function" == typeof s.getItem ? s.getItem("kxkuid") : void 0
                }, a(c), u(c), "next-gen" === p && r(c), n.sendInitial(c), o.run().then(function(t) {
                    return n.sendMore({
                        adUnitWasHidden: t
                    })
                })
            }, f = [], s = function(t) {
                var e, o, i, r;
                if ("complete" === document.readyState) {
                    i = {}, e = t();
                    for (o in e) r = e[o], i[o] = r;
                    return n.sendMore(i)
                }
                return f.push(t)
            }, "function" == typeof window.addEventListener && window.addEventListener("load", function() {
                var t, e, o, i, r, a, u;
                for (i = {}, a = 0, u = f.length; u > a; a++) {
                    t = f[a], e = t();
                    for (o in e) r = e[o], i[o] = r
                }
                return n.sendMore(i)
            }, !1), u = function(n) {
                var e, o, i;
                if (l) {
                    if (o = JSON.parse(window.localStorage.getItem("ophan_follow")), null != o)
                        for (e in o) t.call(o, e) && (i = o[e], n[e] = i);
                    return window.localStorage.removeItem("ophan_follow")
                }
            }, r = function(t) {
                var n, e, o, i, r, a, u;
                if (n = function() {
                        var t, n, o, i;
                        for (o = document.querySelectorAll("[data-component]"), i = [], t = 0, n = o.length; n > t; t++) e = o[t], i.push(e.getAttribute("data-component"));
                        return i
                    }(), n.length > 0) {
                    for (i = {}, a = 0, u = n.length; u > a; a++) e = n[a], i[e] = 1;
                    return t.renderedComponents = function() {
                        var t;
                        t = [];
                        for (o in i) r = i[o], t.push(o);
                        return t
                    }()
                }
            }, v = function(n) {
                var e, o, i;
                if (l) {
                    e = JSON.parse(window.localStorage.getItem("ophan_follow")) || {};
                    for (o in n) t.call(n, o) && (i = n[o], e[o] = i);
                    return window.localStorage.setItem("ophan_follow", JSON.stringify(e))
                }
            }, a = function(t) {
                var n, e, o;
                return n = "undefined" != typeof guardian && null !== guardian && null != (e = guardian.config) && null != (o = e.page) ? o.contentType : void 0, null != n && "" !== n ? t.contentType = n.toLowerCase() : void 0
            }, {
                init: c,
                storeDataToSendOnNextEvent: v,
                onLoadCapture: s,
                servingPlatform: function() {
                    return p
                },
                viewId: n.viewId,
                sendInitialEvent: h
            }
        })
    }.call(this),
    function() {
        define("ophan/components", [], function() {
            var t, n, e;
            return n = [], e = null, t = function() {
                function t(t, n, o, i) {
                    this.name = t, this.element = n, this.visibilityThreshold = o, this.reportingInterval = i, this.visible = !1, this.totalAttentionMs = 0, this.unrecordedAttentionStarted = null, this.reportedTotalAttentionMs = 0, this.usingEmitter = !1, this.visCheck = this.checkVisibility.bind(this), null != e ? (this.usingEmitter = !0, e.on("window:throttledScroll", this.visCheck)) : window.addEventListener("scroll", this.visCheck), window.addEventListener("resize", this.visCheck)
                }
                return t.prototype.isVisible = function(t) {
                    var n, e, o, i, r;
                    return null == t && (t = 1), this.element.offsetParent ? (n = this.element.getBoundingClientRect(), o = n.right - n.left, e = n.bottom - n.top, i = window.innerHeight || document.documentElement.clientHeight, r = window.innerWidth || document.documentElement.clientWidth, n.left >= -(o * (1 - t)) && n.top >= -(e * (1 - t)) && n.right <= r + o * (1 - t) && n.bottom <= i + e * (1 - t)) : !1
                }, t.prototype.visibilityHasChanged = function() {
                    var t;
                    return t = this.visible, this.visible = this.isVisible(this.visibilityThreshold), t !== this.visible
                }, t.prototype.rebindToEventEmitter = function() {
                    return this.usingEmitter || null == e ? void 0 : (window.removeEventListener("scroll", this.visCheck), this.usingEmitter = !0, e.on("window:throttledScroll", this.visCheck))
                }, t.prototype.checkVisibility = function() {
                    return this.rebindToEventEmitter(), this.visibilityHasChanged() ? this.visible ? this.makeActive() : this.makeInactive() : void 0
                }, t.prototype.makeActive = function() {
                    return null != this.unrecordedAttentionStarted ? this.unrecordedAttentionStarted : this.unrecordedAttentionStarted = new Date
                }, t.prototype.makeInactive = function() {
                    return this.incrementTotalAttentionTimeByUnrecordedAmount(), this.unrecordedAttentionStarted = null
                }, t.prototype.hadAttentionSinceLastGet = function() {
                    return this.incrementTotalAttentionTimeByUnrecordedAmount(), this.totalAttentionMs !== this.reportedTotalAttentionMs
                }, t.prototype.getAttentionTime = function() {
                    return this.incrementTotalAttentionTimeByUnrecordedAmount(), this.reportedTotalAttentionMs = this.totalAttentionMs, this.totalAttentionMs
                }, t.prototype.incrementTotalAttentionTimeByUnrecordedAmount = function() {
                    var t, n;
                    return null != this.unrecordedAttentionStarted ? (t = new Date, n = Math.min(t.getTime() - this.unrecordedAttentionStarted.getTime(), this.reportingInterval), this.totalAttentionMs += n, this.unrecordedAttentionStarted = t) : void 0
                }, t
            }(), {
                setEventEmitter: function(t) {
                    return e = t
                },
                startMonitoring: function() {
                    var t, e, o, i;
                    for (i = [], e = 0, o = n.length; o > e; e++) t = n[e], t.isVisible() && i.push(t.makeActive());
                    return i
                },
                stopMonitoring: function() {
                    var t, e, o, i;
                    for (i = [], e = 0, o = n.length; o > e; e++) t = n[e], i.push(t.makeInactive());
                    return i
                },
                getAttentionTimes: function() {
                    var t, e, o, i;
                    for (e = {}, o = 0, i = n.length; i > o; o++) t = n[o], t.hadAttentionSinceLastGet() && (e[t.name] = t.getAttentionTime());
                    return e
                },
                registerComponent: function(e, o, i, r) {
                    return n.push(new t(e, o, i, r))
                }
            }
        })
    }.call(this),
    function() {
        define("ophan/attention", ["ophan/transmit", "ophan/components"], function(t, n) {
            var e, o, i, r, a, u, l, d, c, s, f, p, h, v, m, g;
            return e = 5e3, o = ["focus", "click", "scroll", "mousemove", "touchstart", "touchend", "touchcancel", "touchleave", "touchmove", "keyup", "keydown"], i = 1e4, v = 0, m = null, f = 0, a = null, g = !1, r = function() {
                return null != a && window.clearTimeout(a), a = null
            }, c = function() {
                return null == m && (m = new Date), n.startMonitoring(), r(), a = window.setTimeout(function() {
                    return g ? void 0 : s()
                }, e)
            }, u = function() {
                var t, n;
                return null != m ? (t = new Date, n = Math.min(t.getTime() - m.getTime(), i), v += n, m = t) : void 0
            }, s = function() {
                return r(), n.stopMonitoring(), u(), m = null
            }, p = function() {
                var e, o;
                return u(), v !== f ? (o = {
                    attentionMs: v
                }, e = n.getAttentionTimes(), Object.keys(e).length && (o.componentAttentionMs = e), t.sendMore(o), f = v) : void 0
            }, d = function(t, e, o) {
                return null == o && (o = .5), n.registerComponent(t, e, o, i)
            }, l = function(t) {
                var n, e, r;
                for (e = 0, r = o.length; r > e; e++) n = o[e], window.addEventListener(n, c);
                return document.addEventListener(t.changeEvent, function() {
                    return "visible" === t.state() ? c() : s()
                }, !1), document.body.addEventListener("videoPlaying", function() {
                    return g = !0, c()
                }), document.body.addEventListener("videoEnded", function() {
                    return g = !1, s()
                }), document.body.addEventListener("videoPause", function() {
                    return g = !1, s()
                }), window.setInterval(p, i)
            }, h = function(t) {
                return n.setEventEmitter(t)
            }, {
                init: l,
                initComponent: d,
                setEventEmitter: h
            }
        })
    }.call(this),
    function() {
        define("ophan/privatebrowsing", ["ophan/transmit"], function(t) {
            var n;
            return n = function(t) {
                var n, e, o, i;
                return n = function() {
                    return t(!1)
                }, e = function() {
                    return t(!0)
                }, i = function() {
                    var t;
                    try {
                        return localStorage.length ? n() : (localStorage.x = 1, localStorage.removeItem("x"), n())
                    } catch (o) {
                        return t = o, e()
                    }
                }, o = function() {
                    var t, o;
                    try {
                        return t = indexedDB.open("test"), t.onsuccess = n, t.onerror = e
                    } catch (i) {
                        return o = i, e()
                    }
                }, window.webkitRequestFileSystem ? window.webkitRequestFileSystem(window.TEMPORARY, 1, n, e) : "MozAppearance" in document.documentElement.style ? o() : /constructor/i.test(window.HTMLElement) ? i() : window.indexedDB || !window.PointerEvent && !window.MSPointerEvent ? n() : e()
            }, {
                init: function() {
                    return n(function(n) {
                        var e;
                        return e = {
                            inPrivateBrowsingMode: n
                        }, t.sendMore(e)
                    })
                },
                privateBrowsingMode: n
            }
        })
    }.call(this),
    function() {
        define("ophan/heatmap", [], function() {
            var t, n;
            return t = !1, n = function() {
                var n;
                return n = function() {
                    var n;
                    return "undefined" == typeof localStorage || null === localStorage || t || (t = !0, n = window.location.search.replace(/^(?:.*[&\?]heatmap(?:\=([^&]*))?)?.*$/, "$1"), ("true" === n || "false" === n) && (localStorage.ophan_heatmap = n), "true" !== localStorage.ophan_heatmap && "show" !== n) ? void 0 : document.body.appendChild(document.createElement("script")).src = "//dashboard.ophan.co.uk/assets/js/heatmap-bookmarklet.js"
                }, "complete" === document.readyState ? n() : "function" == typeof window.addEventListener ? window.addEventListener("load", function() {
                    return n()
                }, !1) : void 0
            }, {
                init: n
            }
        })
    }.call(this),
    function() {
        define("ophan/click-path-capture", ["ophan/core", "ophan/transmit"], function(t, n) {
            var e, o, i;
            return i = function(t) {
                var n, e;
                return n = null != t && null != (e = t.nodeName) ? e.toLowerCase() : void 0, "a" === n ? t : null == n || "body" === n ? null : i(t.parentNode)
            }, e = function(t) {
                var n, o;
                return n = null != t && null != (o = t.nodeName) ? o.toLowerCase() : void 0, null == n || "body" === n ? null : ("function" == typeof t.getAttribute ? t.getAttribute("data-component") : void 0) || e(t.parentNode)
            }, o = function(t) {
                var n, e, o;
                return n = function(t) {
                    var n;
                    return (null != t && null != (n = t.nodeName) ? n.toLowerCase() : void 0) === document.body.nodeName.toLowerCase()
                }, e = function(t) {
                    return t === document
                }, (o = function(t, i) {
                    var r;
                    return null == t || n(t) || e(t) ? i : (r = t.getAttribute("data-link-name"), null != r && i.push(r), o(t.parentNode, i))
                })(t, [])
            }, "function" == typeof document.addEventListener ? document.addEventListener("click", function(r) {
                var a, u;
                return a = i(r.target), u = {
                    from: [location.protocol, "//", location.host, location.pathname].join(""),
                    to: a ? a.href : void 0,
                    referringComponent: e(r.target),
                    referringDataLinkNames: o(r.target),
                    refPlatform: t.servingPlatform(),
                    refViewId: t.viewId
                }, null != u.referringDataLinkNames && n.sendMore({
                    clickComponent: u.referringComponent,
                    clickLinkNames: u.referringDataLinkNames
                }), null != a ? t.storeDataToSendOnNextEvent(u) : void 0
            }, !1) : void 0
        })
    }.call(this),
    function() {
        define("ophan/perf", ["ophan/core"], function(t) {
            var n, e;
            return n = window.performance || window.msPerformance || window.webkitPerformance || window.mozPerformance, e = function() {
                var t;
                return t = null != n ? n.timing : void 0, null != t ? {
                    performance: {
                        dns: t.domainLookupEnd - t.domainLookupStart,
                        connection: t.connectEnd - t.connectStart,
                        firstByte: t.responseStart - t.connectEnd,
                        lastByte: t.responseEnd - t.responseStart,
                        domContentLoadedEvent: t.domContentLoadedEventStart - t.responseEnd,
                        loadEvent: t.loadEventStart - t.domContentLoadedEventStart,
                        navType: n.navigation.type,
                        redirectCount: n.navigation.redirectCount
                    }
                } : {}
            }, t.onLoadCapture(e), n
        })
    }.call(this),
    function() {
        var t = {}.hasOwnProperty;
        define("ophan/ipv6", ["ophan/core", "ophan/transmit"], function(n, e) {
            var o, i, r, a, u, l, d, c, s;
            return u = {}, s = [], l = function() {
                var t;
                return t = s.shift(), t ? window.setTimeout(t, 300) : void 0
            }, c = function(n, o) {
                var i;
                return u[n] = o, 3 === function() {
                    var n;
                    n = [];
                    for (i in u) t.call(u, i) && n.push(i);
                    return n
                }().length ? e.sendMore({
                    ipConnectivity: u
                }) : void 0
            }, d = function(t, n) {
                var e;
                return e = new XMLHttpRequest, e.timeout = 5e3, e.open("GET", t, !0), e.ontimeout = function() {
                    return n("timeout")
                }, e.onerror = function() {
                    return n("neterror")
                }, e.onload = function() {
                    var t;
                    return 200 === e.status ? (t = e.responseText, n("success" + t)) : n("loaderror")
                }, e.send()
            }, i = function(t) {
                return 0 === t.lastIndexOf("success", 0)
            }, o = function(t, n) {
                return c(t, n), l()
            }, r = function(t, n) {
                return function(e) {
                    var r;
                    return i(e) ? o(t, e) : (r = function(n) {
                        return i(n) || e === n ? o(t, n) : void 0
                    }, s.push(function() {
                        return d(n, r)
                    }), l())
                }
            }, a = function(t, n) {
                return s.push(function() {
                    return d(n, r(t, n))
                })
            }, a("ipv4", "https://ipv4.guim.co.uk/"), a("dual", "https://dual.guim.co.uk/"), a("ipv6", "https://ipv6.guim.co.uk/"), Math.floor(20 * Math.random()) % 20 === 0 ? l() : void 0
        })
    }.call(this),
    function() {
        define("ophan/ng", ["ophan/core", "ophan/transmit", "ophan/attention", "ophan/visibility", "ophan/privatebrowsing", "ophan/heatmap", "ophan/click-path-capture", "ophan/perf", "ophan/ipv6"], function(t, n, e, o, i, r) {
            var a;
            return null != (null != (a = window.guardian) ? a.ophan : void 0) ? window.guardian.ophan : (t.init("next-gen"), i.init(), r.init(), null != window.addEventListener && e.init(o), null == window.guardian && (window.guardian = {}), window.guardian.ophan = {
                setEventEmitter: e.setEventEmitter,
                trackComponentAttention: e.initComponent,
                record: n.sendMore,
                viewId: n.viewId,
                pageViewId: n.viewId
            })
        })
    }.call(this);
//# sourceMappingURL=ophan.ng.js.map