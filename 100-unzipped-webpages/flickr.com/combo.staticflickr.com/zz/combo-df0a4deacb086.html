YUI.add("search-helper",function(e){function t(e,t){var a;for(a in l){if(!t&&a===e)return l[a];if(t&&l[a]===e)return a}}var a=require("hermes-core/type-validator"),s=["q","ss","ct","mt","l","s","w","d","m","hd","b","a","g","e","cm","xel","xeh","xal","xah","xfl","xfh","eui"],r={userId:"user_id",groupId:"group_id",groupPathAlias:"group_path_alias",setId:"set_id",page:"page",text:"text",tags:"tags",tagMode:"tag_mode",sort:"sort",safeSearch:"safe_search",contentType:"content_type",mediaType:"media",license:"license",faves:"faves",contacts:"contacts",getty:"is_getty",commons:"is_commons",marketplace:"marketplace_licensable",minTakenDate:"min_taken_date",maxTakenDate:"max_taken_date",minUploadDate:"min_upload_date",maxUploadDate:"max_upload_date",hasGeo:"has_geo",boundingBox:"bbox",accuracy:"accuracy",woeId:"woe_id",camera:"camera",minExposure:"exif_min_exposure",maxExposure:"exif_max_exposure",minAperture:"exif_min_aperture",maxAperture:"exif_max_aperture",minFocalLength:"exif_min_focallen",maxFocalLength:"exif_max_focallen",excludeUserId:"exclude_user_id",foursquareWoeId:"foursquare_woeid",foursquareVenueId:"foursquare_venueid",slideshowStartId:"jump_to",height:"height",width:"width",dimensionSearchMode:"dimension_search_mode",orientation:"orientation",colorCodes:"color_codes",styles:"styles",similarityId:"similarity_id"},n={relevant:"relevance",recent:"date-posted-desc",interesting:"interestingness-desc",name:"exact-name-match-first",activity:"most-activity",size:"most-members",oldest:"oldest-first",newest:"recent-first",oldestJoined:"age",mostPhotos:"pho",dateUploaded:"date-posted-desc",dateTaken:"date-taken-desc"},o=["s","q","see","m"],i={username:"username",userId:"user_id",sort:"sort"},c=["q","s","m"],d={text:"text",sort:"sort",safeSearch:"safe_search",userId:"user_id",subscriptionTypes:"subscription_types",filterInactive:"filter_inactive_groups"},l={all:"0,1,2,3,4,5,6,7,8,9,10",cc:"1,2,3,4,5,6,9",deriv:"1,2,4,5,9,10",comm:"4,5,6,9,10",commderiv:"4,5,9,10"},u=[r.tags,r.tagMode,r.mediaType,r.minTakenDate,r.maxTakenDate,r.minUploadDate,r.maxUploadDate,r.height,r.width,r.dimensionSearchMode,r.orientation,r.marketplace,r.excludeUserId],m=[r.colorCodes,r.styles],p=[r.sort,r.safeSearch,r.license],h=[r.userId,r.groupId,r.faves,r.contacts,r.commons,"m","w"],f=[r.userId,r.groupId,r.faves,r.contacts,r.safeSearch,r.sort,r.license,r.tags,r.text],g={sort:n.relevant,parse_tags:"1",content_type:"7"};e.SearchHelper={API:r,PEOPLE_SEARCH_API:i,GROUPS_SEARCH_API:d,GROUPS_SAFE_SEARCH_SETTINGS:{safe:1,all:2,eighteenPlusOnly:3},API_SORT_OPTIONS:n,API_ORIENTATION_OPTIONS:{portrait:"portrait",square:"square",landscape:"landscape",panorama:"panorama"},LICENSE_TYPE:l,UNIFIED_STATE_PARAMS:{viewAll:"view_all",viewType:"view_type",advanced:"advanced",albums:"album_search"},UNIFIED_ADVANCED_PARAMS:u,UNIFIED_QUICK_FILTER_PARAMS:m,UNIFIED_TOOLBAR_PARAMS:p,SEARCH_SCOPE_PARAMS:h,UNIFIED_DEFAULT_PARAMS:g,decodeContentType:function(e){var
t={};switch(parseInt(e,10)){case 1:t.photos=!0;break;case 2:t.screenshots=!0;break;case 3:t.other=!0;break;case 4:t.photos=!0,t.screenshots=!0;break;case 5:t.other=!0,t.screenshots=!0;break;case 6:t.photos=!0,t.other=!0;break;default:t.photos=!0,t.screenshots=!0,t.other=!0}return
t},encodeContentType:function(e){var t=0;return!e.photos||e.screenshots||e.other?e.photos||!e.screenshots||e.other?e.photos||e.screenshots||!e.other?e.photos&&e.screenshots&&!e.other?t=4:!e.photos&&e.screenshots&&e.other?t=5:e.photos&&!e.screenshots&&e.other?t=6:e.photos&&e.screenshots&&e.other&&(t=7):t=3:t=2:t=1,t},isParameterlessSearch:function(e){return!(e[r.userId]||e[r.groupId]||e[r.tags]||e[r.text]||e[r.license]||e[r.faves]||e[r.contacts]||e[r.getty]||e[r.commons]||e[r.minTakenDate]||e[r.maxTakenDate]||e[r.minUploadDate]||e[r.maxUploadDate]||e[r.hasGeo]||e[r.boundingBox]||e[r.woeId]||e[r.camera]||e[r.minExposure]||e[r.maxExposure]||e[r.minAperture]||e[r.maxAperture]||e[r.minFocalLength]||e[r.maxFocalLength]||e[r.foursquareWoeId]||e[r.foursquareVenueId]||e[i.username]||e[r.similarityId])},mapRouteParamsToAPI:function(e){var
t,s={nsid_or_path_alias:"userId",group_id:"groupId",set_id:"setId",page_number:"page",tag_list:"tags",location:"text",slideshow_start_id:"slideshowStartId"},n={};for(t in s)e[t]&&(n[r[s[t]]]=e[t]);return n[r.groupId]&&!a.nsid(n[r.groupId])&&(n[r.groupPathAlias]=n[r.groupId],delete
n[r.groupId]),n},convertLicenseTypeValue:t,mapClassicSearchToAPI:function(t,o){if(!t)return{};var i,c,d,u,m={},p=o.getViewer(),h=t.l,f=t.s,g=t.w,_=t.m,I=t.q;if(t.d&&"string"==typeof t.d&&(d=t.d.split("-")),t.q&&(m[r.text]=t.q),void 0!==t.ss&&(m[r.safeSearch]=parseInt(t.ss,10)+1),void
0!==t.ct&&(m[r.contentType]=parseInt(t.ct,10)+1),void 0!==t.mt&&(m[r.mediaType]=t.mt),t.b&&(m[r.boundingBox]=t.b),t.a&&(m[r.accuracy]=t.a),t.e&&(m[r.woeId]=t.e),t.g&&(m[r.groupId]=t.g),t.cm&&(m[r.camera]=t.cm),void 0!==t.xel&&(m[r.minExposure]=t.xel),void
0!==t.xeh&&(m[r.maxExposure]=t.xeh),void 0!==t.xal&&(m[r.minAperture]=t.xal),void 0!==t.xah&&(m[r.maxAperture]=t.xah),void 0!==t.xfl&&(m[r.minFocalLength]=t.xfl),void 0!==t.xfh&&(m[r.maxFocalLength]=t.xfh),t.eui&&(m[r.excludeUserId]=t.eui),void 0!==h)switch(h){case"cc":case"comm":case"deriv":case"commderiv":m[r.license]=l[h];break;default:(c=parseInt(h,10))>=0&&c
<=10&&(m[r.license]=c)}if(f)switch(f){case
    "rec":m[r.sort]=n.recent;break;case "rel":m[r.sort]=n.relevant;break;case "int":m[r.sort]=n.interesting}if(t.hd&&(m[r.media]="hdvideo" ),g&& "string"==typeof g)if(-1!==g.indexOf( "faves"))u=g.split( "-"),m[r.faves]=1,u.length>1?m[r.userId]=u[1]:p.signedIn&&(m[r.userId]=p.nsid);else if(a.nsid(g))"pool"===_?m[r.groupId]=g:m[r.userId]=g;else switch(g){case"contacts":m[r.contacts]="all";break;case"ff":m[r.contacts]="ff";break;case"getty":m[r.getty]="true";break;case"commons":m[r.commons]="true";break;case"usg":m[r.license]=8}if(d)switch(d[0]){case"taken":d[1]&&(m[r.minTakenDate]=e.flutil.parseYYYYMMDDDatestamp(d[1])/1e3),d[2]&&(m[r.maxTakenDate]=e.flutil.parseYYYYMMDDDatestamp(d[2])/1e3);break;case"posted":d[1]&&(m[r.minUploadDate]=e.flutil.parseYYYYMMDDDatestamp(d[1])/1e3),d[2]&&(m[r.maxUploadDate]=e.flutil.parseYYYYMMDDDatestamp(d[2])/1e3)}if(_&&I)switch(_){case"tags":delete(m=e.merge(m,this.processTags(I)))[r.text]}for(i
    in t)-1===s.indexOf(i)&&(m[i]=t[i]);return m},mapClassicPeopleSearchToAPI:function(e,t){var a={},s=null,r=t.getViewer();if((e=e||{}).q&&(a[i.username]=e.q),e.s)switch(e.s){case"age":a[i.sort]=n.oldestJoined;break;case"pho":a[i.sort]=n.mostPhotos}e.see&&"all"===e.see.toString().toLowerCase()&&r.signedIn&&(a[i.userId]=r.nsid),e.m&&(e.m.toString().toLowerCase(),e.m.toString().toLowerCase());for(s
    in e)-1===o.indexOf(s)&&(a[s]=e[s]);return a},mapClassicGroupSearchToApi:function(e,t){var a,s={},r=null;if(e=e||{},a=e.m&&"discuss"===e.m.toString().toLowerCase(),e.q&&(s[d.text]=e.q),e.s)switch(e.s){case"act":s[d.sort]=a?n.discussionActivity:n.activity;break;case"siz":s[d.sort]=n.size;break;case"age":s[d.sort]=n.newest}for(r
    in e)-1===c.indexOf(r)&&(s[r]=e[r]);return s},mapAPIParamsToAdvancedSearchQuery:function(e){var a={},s=e[r.userId];return e[r.text]?a.q=e[r.text]:e[r.tags]&&(a.q=e[r.tags]),e[r.faves]?a.w=s?"faves-"+s:"faves":s?a.w=s:"all"===e[r.contacts]?a.w="contacts":"ff"===e[r.contacts]?a.w="ff":"true"===e[r.getty]?a.w="getty":"true"===e[r.commons]?a.w="commons":8===parseInt(e[r.license],10)&&(a.w="usg"),e[r.license]&&(a.l=t(e[r.license],!0)),a},deriveScopeTitle:function(t,s){var
    n,o=s.getViewer();return t[r.userId]?o&&o.signedIn&&o.nsid===t[r.userId]?t[r.faves]?e.Promise.resolve({intlName:"search.VIEWER_FAVES"}):e.Promise.resolve({intlName:"search.YOUR_PHOTOS"}):(n=a.nsid(t[r.userId])?t[r.userId]:{pathAlias:t[r.userId]},s.getModel("person-models",n).then(function(e){var
    a;return a=t[r.faves]?"search.FAVES_POSSESSIVE":"search.PHOTOS_POSSESSIVE",{intlName:a,name:e.getValue("displayname")}})):t[r.contacts]?e.Promise.resolve({intlName:"search.FROM_PEOPLE_YOU_FOLLOW"}):t[r.groupId]||t[r.groupPathAlias]?(n=t[r.groupId]?{id:t[r.groupId]}:{pathAlias:t[r.groupPathAlias]},s.getModel("group-info-models",n).then(function(e){return{intlName:"search.IN_GROUP_POOL",name:e.getValue("group").getValue("title")}})):t[r.faves]?e.Promise.resolve({intlName:"search.VIEWER_FAVES"}):e.Promise.resolve({intlName:"search.EVERYONES_PHOTOS"})},derivePeopleScopeTitle:function(t,s){var
    n,o=s.getViewer();if(t[r.userId])return o&&o.signedIn&&o.nsid===t[r.userId]?e.Promise.resolve({intlName:"search.PEOPLE_YOU_FOLLOW"}):(n=a.nsid(t[r.userId])?t[r.userId]:{pathAlias:t[r.userId]},s.getModel("person-models",n).then(function(e){return{intlName:"search.CONTACTS_POSSESSIVE",name:e.getValue("username")}}))},deriveGroupsScopeTitle:function(t,s){var
    n,o=s.getViewer();if(t[r.userId])return o&&o.signedIn&&o.nsid===t[r.userId]?e.Promise.resolve({intlName:"search.YOUR_GROUPS"}):(n=a.nsid(t[r.userId])?t[r.userId]:{pathAlias:t[r.userId]},s.getModel("person-models",n).then(function(e){return{intlName:"search.GROUPS_POSSESSIVE",name:e.getValue("username")}}))},deriveCCLicenseString:function(e){e||(e={});var
    t=null,a=e[r.license];if(a&&1===a.length)switch(parseInt(a,10)){case 1:t="search.CC_BY_NC_SA";break;case 2:t="search.CC_BY_NC";break;case 3:t="search.CC_BY_NC_ND";break;case 4:t="search.CC_BY";break;case 5:t="search.CC_BY_SA";break;case 6:t="search.CC_BY_ND"}return
    t?{intlName:t}:null},addParamDefaults:function(e,t){!e[r.license]||e[r.license]!==l.all&&""!==e[r.license]||delete e[r.license]},addGroupsParamDefaults:function(e){},addPeopleParamDefaults:function(e){},clearParams:function(e,t){for(var a in e)-1===t.indexOf(a)&&delete
    e[a]},clearAdvancedSearchParams:function(e){this.clearParams(e,f)},clearParamsExceptSearchScope:function(e){this.clearParams(e,h)},generateQueryString:function(t){var a=e.clone(t)||{};return delete a.page,delete a.method,delete a.extras,e.QueryString.stringify(a)},convertSafeSearchPrefsToApi:function(t){var
    a=e.AttributeHelpers.coerceInteger(t);return e.AttributeHelpers.coerceString(a+1)},unescapeParameters:function(t){var a=t[r.groupId],s=t[r.tags],n=t[r.text];YUI.Env.isServer&&(a&&(t[r.groupId]=e.flutil.unescape(a)),s&&(t[r.tags]=e.flutil.unescape(s)),n&&(t[r.text]=e.flutil.unescape(n)))},objectsAreEquivalentToDepth:function(t,a,s){var
    r,n,o=this;return t===a||!(s
    <=0)&&(s=s||1,!(!e.Lang.isObject(t)||!e.Lang.isObject(a))&&(r=Object.keys(t),n=Object.keys(a),r.length===n.length&&r.every(function(e){return o.objectsAreEquivalentToDepth(t[e],a[e],s-1)})))},normalizeTag:function(e){var
        t;return e&&(t=e.replace(/[\s!-\/:-@[-`]/g, "")),t},processTags:function(e,t){if(!e|| "string"!=typeof e)return{};var a,s,n,o,i={},c=/([ "'])(\\?.)*?\1/g,d=/^([,\+]|AND|OR)$/;return a=e.match(c)||[],s=e.replace(c,"
        "),n=s.split(/[,\+\s]/),n=n.map(function(e){return e.trim()}).filter(function(e){return e&&!d.test(e)}),o=a.concat(n),i[r.tags]=o.join(", "),"any "===t||"all "===t?i[r.tagMode]=t:/[\+\s]OR[\+\s]/.test(e)?(i[r.tagMode]="any ",o.length=Math.min(o.length,11)):i[r.tagMode]="all ",i}}},"@VERSION@ ",{requires:["flutil "]});YUI.add("search-url ",function(e,r){function s(e){return"number
        "==typeof e?e.toString():"boolean "==typeof e?e?"1 ":"0 ":"string "==typeof e?e:void 0}var t,a,h=require("hermes-core/flog ")(r),o=/^\/search(?:\/.*)?$/,i=/^bw|blackandwhite$/;t=YUI.Env.isServer?require("querystring
        ").stringify:e.QueryString.stringify,(a=function(r,t,o){var i,c,p,n,P;if(this.appContext=t,"string "==typeof r){if(P=r.split("? "),o?this.searchType=o:(p=-1!==(c=P[0].split("/ "))[0].indexOf("http ")?3:1,n="/ "+c.slice(p).join("/ "),this.searchType=this.getSearchTypeFromPathname(n)),P=P.length>1?P[1]:"
        ",this.params={},P)try{P=e.QueryString.parse(P),this.params=e.SearchHelper.mapClassicSearchToAPI(P,t)}catch(e){h.warn("malformed query
        ",{err:e,query:P})}}else this.params=e.merge(r),this.searchType=o;for(i in this.params)this.params.hasOwnProperty(i)&&(this.params[i]=s(this.params[i]));this.params.color_codes&&(this.colors=this.params.color_codes.toString().split(",
        ")),this.searchType||this.setSearchType(a.searchTypes.UNDEFINED)}).prototype.setSearchType=function(r){var s=this.getSearchTerm();return this.searchType=r,this.params=this.validateParams(this.params,this.searchType),this.params=e.merge(this.getDefaultParams(this.searchType),this.params),s&&this.setSearchTerm(s),this},a.prototype.getSearchTypeFromPathname=function(e){switch(e=e||this.pathname,e=e.toLowerCase(),e=e.split("/ ").join(" ")){case"searchpeople ":return a.searchTypes.PEOPLE;case"searchgroups ":return a.searchTypes.GROUPS;case"search ":default:return a.searchTypes.PHOTOS}},a.prototype.getPathname=function(){var e="/search/
        ";switch(this.searchType){case a.searchTypes.PEOPLE:e+="people/ ";break;case a.searchTypes.GROUPS:e+="groups/ ";break;case a.searchTypes.CLASSIC_GROUPS:e="/search_groups.gne
        ";break;case a.searchTypes.PHOTOS:}return e},a.prototype.validateParams=function(r,s){var t,h,o,i={};switch(r=e.merge(r),s){case a.searchTypes.PEOPLE:(t=e.merge(e.SearchHelper.PEOPLE_SEARCH_API)).text="text
        ";break;case a.searchTypes.GROUPS:t=e.merge(e.SearchHelper.GROUPS_SEARCH_API);break;case a.searchTypes.PHOTOS:t=e.merge(e.SearchHelper.API,e.SearchHelper.UNIFIED_STATE_PARAMS);break;case a.searchTypes.UNDEFINED:default:return r}if(t)for(h in t)void 0!==r[o=t[h]]&&(i[o]=r[o]);return i},a.prototype.getDefaultParams=function(r){var s={};switch(r){case a.searchTypes.PEOPLE:e.SearchHelper.addPeopleParamDefaults(s);break;case a.searchTypes.GROUPS:e.SearchHelper.addGroupsParamDefaults(s);break;case a.searchTypes.PHOTOS:e.SearchHelper.addParamDefaults(s);break;case a.searchTypes.UNDEFINED:}return s},a.prototype.getAPIParams=function(){return e.merge(this.params)},a.prototype.getAPIParam=function(e){return this.params[e]},a.prototype.setAPIParam=function(e,r){return this.params[e]=s(r),this},a.prototype.removeAPIParam=function(e){return delete this.params[e],this},a.prototype.removeAllAPIParams=function(){return this.params={},this},a.prototype.getSearchTerm=function(){var r=this.params[this.getSearchTermKey(this.searchType)];return r||(r=this.params[e.SearchHelper.API.tags]),r||"
        "},a.prototype.setSearchTerm=function(r){var s=this.getSearchTermKey(this.searchType);return delete this.params[e.SearchHelper.PEOPLE_SEARCH_API.username],delete this.params[e.SearchHelper.GROUPS_SEARCH_API.text],delete this.params[e.SearchHelper.API.text],delete this.params[e.SearchHelper.API.tags],delete this.params.q,this.params[s]=r,this},a.prototype.getSearchTermKey=function(r){switch(r){case a.searchTypes.PEOPLE:return e.SearchHelper.PEOPLE_SEARCH_API.username;case a.searchTypes.GROUPS:return e.SearchHelper.GROUPS_SEARCH_API.text;case a.searchTypes.PHOTOS:default:return this.params[e.SearchHelper.API.tags]||"
        "===this.params[e.SearchHelper.API.tags]?e.SearchHelper.API.tags:e.SearchHelper.API.text}},a.prototype.removeScope=function(){return e.SearchHelper.SEARCH_SCOPE_PARAMS.forEach(function(e){this.removeAPIParam(e)}.bind(this)),this.removeAPIParam(e.SearchHelper.API.excludeUserId),this},a.prototype.resetToUnified=function(){return this.params[e.SearchHelper.UNIFIED_STATE_PARAMS.viewAll]&&(this.removeAPIParam(e.SearchHelper.API.userId),this.removeAPIParam(e.SearchHelper.API.contacts),this.removeAPIParam(e.SearchHelper.API.groupId),this.removeAPIParam(e.SearchHelper.UNIFIED_STATE_PARAMS.albums)),this.removeAPIParam(e.SearchHelper.API.similarityId),this.removeAPIParam(e.SearchHelper.UNIFIED_STATE_PARAMS.viewAll),this},a.prototype.hasAdvancedParams=function(r){return Object.keys(this.params).some(function(s){return-1!==e.SearchHelper.UNIFIED_ADVANCED_PARAMS.indexOf(s)||!r&&-1!==e.SearchHelper.UNIFIED_QUICK_FILTER_PARAMS.indexOf(s)||!r&&-1!==e.SearchHelper.UNIFIED_TOOLBAR_PARAMS.indexOf(s)})},a.prototype.resetAdvancedParam=function(r,s){return this.hasAdvancedParams(r)?this.setAPIParam(e.SearchHelper.UNIFIED_STATE_PARAMS.advanced,1):s||this.removeAPIParam(e.SearchHelper.UNIFIED_STATE_PARAMS.advanced),this},a.prototype.createNewSearch=function(e){return this.setSearchTerm(e),this.removeScope(),this.searchType!==a.searchTypes.UNDEFINED&&this.searchType!==a.searchTypes.PHOTOS||(this.resetToUnified(),this.resetAdvancedParam()),this},a.prototype.getURL=function(){var e=this.getId(),r=this.getPathname();return e===a.EMPTY_SEARCH_ID?r:r+"?
        "+e},a.prototype.getId=function(){var r,s={},h=e.SearchHelper.API;for(r in this.params)h[r]?s[h[r]]=this.params[r]:s[r]=this.params[r];return t(s)||a.EMPTY_SEARCH_ID},a.prototype.clone=function(){return new a(this.params,this.appContext,this.searchType)},a.prototype.setMedia=function(r,s){var t;r||(r=!1),s||(s=!1),t=r&&s?"all ":r?"photos ":"videos ",this.setAPIParam(e.SearchHelper.API.mediaType,t)},a.prototype._syncColors=function(){this.colors&&this.colors.length>0?this.params.color_codes=this.colors.join(", "):this.removeAPIParam("color_codes
        ")},a.prototype.addColorCode=function(e){if(e&&e.match(i))return this.clearColorCodes(),this.colors=["bw "],void this._syncColors();this.colors&&-1!==this.colors.indexOf("bw
        ")&&(this.colors=[]),this.colors||(this.colors=[]),-1===this.colors.indexOf(e)&&(this.colors.push(e),this._syncColors())},a.prototype.removeColorCode=function(e){var r;this.colors&&-1!==(r=this.colors.indexOf(e))&&(this.colors.splice(r,1),this._syncColors())},a.prototype.clearColorCodes=function(){this.colors=[],this._syncColors()},a.isSearchUrl=function(e){return o.test(e)},a.searchTypes={UNDEFINED:0,PHOTOS:1,PEOPLE:2,GROUPS:3,CLASSIC_GROUPS:4},a.EMPTY_SEARCH_ID="-1 ",e.SearchUrl=a},"@VERSION@ ",{requires:["search-helper ","querystring-parse-simple ","querystring-stringify-simple "]});YUI.add("hermes-template-search-pill
        ",function(a,e){var n=a.Template.Handlebars.revive({1:function(a,e,n,l,s){var i,r,t=null!=e?e:{},c=n.helperMissing,m=a.escapeExpression;return'<li class="search-pill " '+(null!=(i=n.if.call(t,null!=e?e.id:e,{name:"if ",hash:{},fn:a.program(2,s,0),inverse:a.noop,data:s}))?i:" ")+' title=" '+m("function"==typeof(r=null!=(r=n.name||(null!=e?e.name:e))?r:c)?r.call(t,{name:"name",hash:{},data:s}):r)+'
        ">\n\t<span class="search-pill-name ">'+m("function "==typeof(r=null!=(r=n.name||(null!=e?e.name:e))?r:c)?r.call(t,{name:"name ",hash:{},data:s}):r)+'</span>\n\t<div class="search-pill-divider "></div>\n\t<span class="search-pill-second-name " title="
        '+m("function"==typeof(r=null!=(r=n.secondName||(null!=e?e.secondName:e))?r:c)?r.call(t,{name:"secondName",hash:{},data:s}):r)+' ">'+m("function "==typeof(r=null!=(r=n.secondName||(null!=e?e.secondName:e))?r:c)?r.call(t,{name:"secondName ",hash:{},data:s}):r)+'</span>\n\t<i class="search-pill-remover "></i>\n</li>\n'},2:function(a,e,n,l,s){var i;return"id="+a.escapeExpression("
        function "==typeof(i=null!=(i=n.id||(null!=e?e.id:e))?i:n.helperMissing)?i.call(null!=e?e:{},{name:"id ",hash:{},data:s}):i)},4:function(a,e,n,l,s){var i,r,t=null!=e?e:{},c=n.helperMissing,m=a.escapeExpression;return'<li class="search-pill
        " '+(null!=(i=n.if.call(t,null!=e?e.id:e,{name:"if ",hash:{},fn:a.program(2,s,0),inverse:a.noop,data:s}))?i:" ")+' title=" '+m("function"==typeof(r=null!=(r=n.name||(null!=e?e.name:e))?r:c)?r.call(t,{name:"name",hash:{},data:s}):r)+' "><span class="search-pill-name ">'+m("function
        "==typeof(r=null!=(r=n.name||(null!=e?e.name:e))?r:c)?r.call(t,{name:"name ",hash:{},data:s}):r)+'</span><i class="search-pill-remover "></i></li>\n'},compiler:[7,">= 4.0.0"],main:function(a,e,n,l,s){var i;return null!=(i=n.if.call(null!=e?e:{},null!=e?e.combo:e,{name:"if",hash:{},fn:a.program(1,s,0),inverse:a.program(4,s,0),data:s}))?i:""},useData:!0}),l={};a.Array.each([],function(e){var n=a.Template.get("hermes/"+e);n&&(l[e]=n)}),a.Template.register("hermes/search-pill",function(e,s){return
        s=s||{},s.partials=s.partials?a.merge(l,s.partials):l,n(e,s)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-search-autosuggest-field",function(e,a){var l=e.Template.Handlebars.revive({1:function(e,a,l,s,t){var
        n;return null!=(n=e.invokePartial(s["search-pill"],a,{name:"search-pill",data:t,indent:"\t\t",helpers:l,partials:s,decorators:e.decorators}))?n:""},3:function(e,a,l,s,t){return' placeholder="'+e.escapeExpression((l.intlMessage||a&&a.intlMessage||l.helperMissing).call(null!=a?a:{},{name:"intlMessage",hash:{intlName:"search.PHOTOS_PEOPLE_OR_GROUPS"},data:t}))+'"'},compiler:[7,">=
        4.0.0"],main:function(e,a,l,s,t){var n,r,i,c=null!=a?a:{},h=l.helperMissing,o=e.escapeExpression,u='
        <form method="get" action="/search/" role="search" class="search-form">\n\n\t<label data-track="gnSearchSearchIcon" aria-label="'+o((l.intlMessage||a&&a.intlMessage||h).call(c,{name:" intlMessage ",hash:{intlName:"search.SEARCH "},data:t}))+'">\n\t\t<svg class="icon search-icon" style="width: 22px; height: 22px;" data-track="gnSearchSearchIcon" aria-label="'+o((l.intlMessage||a&&a.intlMessage||h).call(c,{name:"intlMessage",hash:{intlName:"search.SEARCH"},data:t}))+'"><use xlink:href="#icon-search"></use></svg>\n\t\t<input type="submit" data-track="gnSearchSearchIcon" class="search-icon-button" tabindex="-1" aria-label="'+o((l.intlMessage||a&&a.intlMessage||h).call(c,{name:"intlMessage",hash:{intlName:"search.SEARCH"},data:t}))+'" role="button">\n\t</label>\n\t
            <ul
                class="search-pillbox">\n';return r=null!=(r=l.pills||(null!=a?a.pills:a))?r:h,i={name:"pills",hash:{},fn:e.program(1,t,0),inverse:e.noop,data:t},n="function"==typeof r?r.call(c,i):r,l.pills||(n=l.blockHelperMissing.call(a,n,i)),null!=n&&(u+=n),u+'\t</ul>\n\t
                <input
                    type="text" id="search-field" class="autosuggest-selectable-item" '+(null!=(n=l.unless.call(c,null!=a?a.hasPills:a,{name:"unless",hash:{},fn:e.program(3,t,0),inverse:e.noop,data:t}))?n:"")+' name="text" value="'+o(" function
                    "==typeof(r=null!=(r=l.searchTerm||(null!=a?a.searchTerm:a))?r:h)?r.call(c,{name:"searchTerm ",hash:{},data:t}):r)+'" autocomplete="off" aria-label="'+o((l.intlMessage||a&&a.intlMessage||h).call(c,{name:" intlMessage ",hash:{intlName:"search.SEARCH "},data:t}))+'" role="textbox">\n\n</form>\n\n'+o((l.outlet||a&&a.outlet||h).call(c,null!=a?a["search-autosuggest-items-list-view"]:a,{name:"outlet",hash:{},data:t}))+"\n"},usePartial:!0,useData:!0}),s={};e.Array.each(["search-pill"],function(a){var l=e.Template.get("hermes/"+a);l&&(s[a]=l)}),e.Template.register("hermes/search-autosuggest-field",function(a,t){return
        t=t||{},t.partials=t.partials?e.merge(s,t.partials):s,l(a,t)})},"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-search-pill"]});YUI.add("model-proxy",function(e,t){var r=require("hermes-core/flog")(t);e.getModelProxyConstructor=function(t){var
        o;return o=function(e){this.id=e,this.registry=t,this.isModel=!0},o.prototype={},e.getModelProxyConstructor.skipList.forEach(function(e){o.prototype[e]=function(){var t=new Error("Registry methods are not exposed on models.");throw r.error({err:t,method:e}),t}}),e.Object.each(t,function(r,n){o.prototype[n]||0!==n.indexOf("_")&&e.Lang.isFunction(r)&&(Object.keys(r.prototype).length>0||(o.prototype[n]=(function(e){return
        function(){for(var r=new Array(arguments.length),o=0;o
        <r.length;++o)r[o]=arguments[o];return r.unshift(this.id),t[e].apply(t,r)}})(n)))},this,!0),o},e.getModelProxyConstructor.skipList=[ "add", "get", "load", "proxy", "remoteRead",
            "remoteCreate", "attributeSearch", "removeAll", "getCount", "serialize", "deserialize"]}, "@VERSION@",{requires:[]});YUI.add( "flickr-collection",function(t){var i,n={};(i=t.FlickrCollection=function(t,i,n){this.registry=t,this.id=i,this.attrName=n,this._data=[],this.fetchedStart=!1,this.fetchedEnd=!1,this.totalItems=Number.MAX_VALUE}).prototype={constructor:i,push:function(t){var
            i=this._data.concat();i.push(t),this.registry.setValue(this.id,this.attrName,i)},unshift:function(t){var i=this._data.concat();i.unshift(t),this.registry.setValue(this.id,this.attrName,i)},concat:function(t){var i=this._data.concat(t);this.registry.setValue(this.id,this.attrName,i)},remove:function(t){
            "string"==typeof t&&(t={id:t});var i,n=this.find(t,!0);return n&&((i=this._data.concat()).splice(n.index,1),this.registry.setValue(this.id,this.attrName,i)),n&&n.value},find:function(t,i){if(!t)return null;var n=null,e=Object.keys(t);return this._data.some(function(i,r){if(i)return
            e.every(function(n){return i[n]===t[n]})?(n={value:i,index:r},!0):void 0}),i?n:n?n.value:null},getFirstItem:function(){var t,i;for(t=0;t<this._data.length;t++)if(i=this._data[t])return{item:i,index:t};return null},getLastItem:function(){var t,i;for(t=this._data.length-1;t>=0;t--)if(i=this._data[t])return{item:i,index:t};return null},getList:function(){return this._data.concat()},size:function(){return this._data.length},toJSON:function(){var i=[];return t.Array.each(this.getList(),function(t){t&&i.push(t.toJSON())}),i},toString:function(){return
            this.registry.name+'["'+this.attrName+'"]'},appendToListMulti:function(t){this.concat(t)},appendToList:function(t){this.push(t)},prependToList:function(t){this.unshift(t)},getFromListByID:function(t,i){var n={};return n[i||"id"]=t,this.find(n)||void
            0},removeFromList:function(t,i){var n={};return n[i||"id"]=t,this.remove(n)},hasMinBoundary:function(){return this.fetchedStart},hasMaxBoundary:function(){return this.fetchedEnd},_setValue:function(t){this._data=t}},t.FlickrCollection.executeFetch=function(i,e,r,a){var
            s;return a&&t.Lang.isFunction(a.run)?(s=JSON.stringify(i),n[s]||(n[s]=a.run.call(a,i,e.appContext).then(function(t){return delete n[s],t},function(t){throw delete n[s],t}),n[s])):t.Promise.reject("(flickr-collection::executeFetch) invalid
            fetcher for "+e.name+"["+r+"]")},t.FlickrCollection.trimArray=function(t){for(var i=0,n=t.length-1;i
            <t.length&&!t[i];)i++;for(;n>i&&!t[n];)n--;return t.slice(i,n+1)}},"@VERSION@",{requires:[]});YUI.add("paged-collection",function(t,e){var a=require("hermes-core/flog")(e);t.PagedCollection=function(t,e,a,s){this.constructor.superclass.constructor.call(this,t,e,a),s&&(s
                instanceof Array&&(s={pageContent:s,page:1,perPage:s.length}),s.totalPages&&(this.totalPages=s.totalPages),void 0===typeof s.totalItems||isNaN(parseFloat(s.totalItems))||(this.totalItems=parseFloat(s.totalItems)),this.fetchedStart=!!s.fetchedStart,this.fetchedEnd=!!s.fetchedEnd,this.addPage(s))},t.extend(t.PagedCollection,t.FlickrCollection,{getPage:function(e){var
                a,s,i,o,r,n,h;if(e&&e.page&&e.perPage&&!e.forceAPICall){if(n=this.totalPages&&e.page>=this.totalPages,h=this.totalItems&&s>=this.totalItems,a=e.perPage*(e.page-1),s=Math.min(e.perPage*e.page,this.totalItems),!n&&!h||!this.fetchedEnd)for(i=a;i
                <s;i++)if(void
                    0===this._data[i]||!this._data[i].exists()){o=!0;break}}else e||(e={}),o=!0;return o?(e.pathAlias||(e.id=this.id),e.isCollection=!0,(r=this.registry.attributes[this.attrName].pageFetch).fetchParams&&(e=t.merge(e,r.fetchParams)),t.FlickrCollection.executeFetch(e,this.registry,this.attrName,r.listFetcher)):t.Promise.resolve(this._data.slice(a,s))},addPage:function(t){var
                    e,a,s=t.perPage*(t.page-1),i=s+Math.min(t.pageContent.length,t.perPage),o=0;if(t.forceAppend)this._data=this._data.concat(t.pageContent);else if(this._data.length<=s)this._data.length=s,this._data=this._data.concat(t.pageContent);else
                    for(this._data.length<i&&(this._data.length=i),e=s;e<i;e++)this._data[e]=t.pageContent[o],o++;t.totalPages&&(this.totalPages=t.totalPages,t.page>=this.totalPages&&(this.fetchedEnd=!0)),void 0===typeof t.totalItems||isNaN(parseFloat(t.totalItems))||(a=parseFloat(t.totalItems),this.totalItems=a,this._data.length>=a?this.fetchedEnd=!0:s+parseInt(t.perPage,10)>a&&this._data.length
                    <a&&(this.fetchedEnd=!0)),this.fetchedStart=this._data&&void
                        0!==this._data[0]},removePage:function(t){},getPageOf:function(t,e){e||(a.warn( "`perPage` must be specified; defaulting to 50."),e=50);var s=this.find(t,!0);return s?Math.floor(s.index/e)+1:-1},getNextIncompletePage:function(t){var
                        e=t.page*(t.perPage-1),a=Math.floor(this._data.length/t.perPage)+1;for(e;e<this._data.length;e++)if(void 0===this._data[e]||!this._data[e].exists()){a=Math.floor(e/t.perPage)+1;break}return a},_setValue:function(e){if(e instanceof
                        Array)this.constructor.superclass._setValue.call(this,e);else{if(!(e=(function(e){return e?(e instanceof Array&&(e={pageContent:e}),e=t.merge({page:1,perPage:0,pageContent:[]},e)):(a.warn(
                        "No pageData sent to PagedCollection; aborting."),null)})(e)))return;e.remove?this.removePage(e):this.addPage(e)}}})}, "@VERSION@",{requires:[ "flickr-collection"]});YUI.add( "flickr-model-registry",function(e,t){function i(t,s,a){return!1===a&& "string"==typeof t&& "string"==typeof
                        s&&(t=t.toLowerCase(),s=s.toLowerCase()),t===s||(e.moment.isMoment(t)&&e.moment.isMoment(s)?0===t.diff(s):!!(e.Lang.isArray(t)&&e.Lang.isArray(s)&&(function(t,s){var a=!0;t.length!==s.length&&(a=!1);a&&e.Array.some(t,function(e,t){if(!i(s[t],e))return
                        a=!1,!0});return a})(t,s))||!!(e.Lang.isObject(t,!0)&&e.Lang.isObject(s,!0)&&(function(t,s){var a=!0;e.Object.size(t)!==e.Object.size(s)&&(a=!1);a&&e.Object.some(t,function(e,t){if(!s.hasOwnProperty(t)||!i(s[t],e))return a=!1,!0});a&&e.Object.some(s,function(e,s){if(!t.hasOwnProperty(s)||!i(t[s],e))return
                        a=!1,!0});return a})(t,s)))}function s(t){var i=t;return "object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Array.prototype?(i=t.slice(),void 0!==t.hasMinBoundary&&(i.hasMinBoundary=t.hasMinBoundary),void 0!==t.hasMaxBoundary&&(i.hasMaxBoundary=t.hasMaxBoundary)):Object.getPrototypeOf(t)===Object.prototype&&(i={},e.Object.each(t,function(e,t){i[t]=e},this))),i}var
                        a=require( "hermes-core/flog")(t);e.Models={};var r=e.FlickrModelRegistry=function(t){this.appContext=t,this.attributes=this.attributes||{},this.attributes.id={writeOnce: "initOnly",setter:function(t){return e.Lang.isString(t)||(e.Lang.isNumber(t)?t+=""
                        :(a.info( "`id` falling back to a Y.guid",{topic:this.name,val:t}),t=e.guid())),t}},this._setDefaultRemoteMethods(),this._validateAttributes(),this._data={},this._dataSize=0,this._subscribers=[],this.hasWeakSubscribers=!1,this._chainedEvents={},this._derivedCache=void
                        0,this._unsavedModels={}};r.prototype={attributeSearch:function(t,s){var a=[];return t.id?a.push(t.id):e.Object.each(this._data,function(r,n){var o=!0;e.Object.some(t,function(e,t){if(!i(e,r[t],!1)){if(!0!==s)return o=!1,!0;if(!i(e,this.getDefaultValue(r.id,t),!1))return
                        o=!1,!0}},this),o&&a.push(n)},this),a},load:function(t,i){var s,a,r=this;return i||(i={}),e.Lang.isObject(t,!0)?(s=this.attributeSearch(t).sort()[0],i=e.merge(t,i||{})):(s=t,i=e.merge({id:s},i)),s&&this.exists(s)?e.Promise.resolve(s):(this._fetchPromises||(this._fetchPromises={}),a=s||JSON.stringify(i),this._fetchPromises[a]?this._fetchPromises[a]:(this._fetchPromises[a]=this.remoteRead(i).then(function(){var
                        e,i,n=s;if(s||(e=r.attributeSearch(t)).length>0&&(n=e[0]),delete r._fetchPromises[a],n&&r.exists(n))return n;throw i=new Error("["+r.name+"] Model ID is missing after fetching."),i.getModelFailure=!0,i}),this._fetchPromises[a]))},get:function(e,t){return this.load(e,t).then(this.proxy.bind(this))},add:function(t,i,s){var
                        r;{if(e.Lang.isObject(t,!0)&&!e.Lang.isArray(t))return void 0===i&&(i=!1),r=this.attributes.id.setter.apply(this,[t.id,void 0]),this._data[r]?a.warn("Attempt to add a model that is already in the registry.",{topic:this.name,id:r}):(this._data[r]={},this._dataSize++,this._queueEvent("modelsAdded",{id:r}),i?this._data[r]=t:Object.keys(this.attributes).forEach(function(e){var
                        i=this.attributes[e],a=t[e];i.readOnly||this.setValue(r,e,a,!0,s)},this),this.appContext.markAsNewlyFetched(this.name,r)),this.proxy(r);a.warn("`add` requires an object",{topic:this.name,data:t})}},remove:function(e){this.exists(e)&&(delete
                        this._data[e],this._dataSize--,this._removeChainedEvents(e),this._removeEventSubscribers(e),this._queueEvent("modelsRemoved",{id:e}))},removeAll:function(){e.Object.each(this._data,function(e,t){this.remove(t)},this)},removeAllExcept:function(t){var
                        i=t.reduce(function(e,t){return e[t]=!0,e},{});e.Object.each(this._data,function(e,t){i[t]||this.remove(t)},this)},_removeChainedEvents:function(t){var i;this._chainedEvents[t]&&(e.Object.each(this._chainedEvents[t],function(t,s){(i=this.attributes[s])&&(i.isModel?t.detach():(i.isListProxy||i.isCollection)&&e.Array.each(t,function(e){e.detach&&e.detach()}))},this),delete
                        this._chainedEvents[t])},_removeEventSubscribers:function(t){var i=[];this._subscribers.length&&(e.Array.each(this._subscribers,function(e,s){e.id===t&&i.push(s)},this),e.Array.each(i,function(e){this._subscribers.splice(e,1)},this))},proxy:function(t){return
                        this._ModelProxy||(this._ModelProxy=e.getModelProxyConstructor(this)),new this._ModelProxy(t)},getValue:function(t,i,r){var n,o,h;if(t&&i)if(this.exists(t)){if(o=this.attributes[i])return o.isListProxy?n=new e.ListProxy(this,t,i):(void
                        0===(n=this._data[t][i])&&(n=this.getDefaultValue(t,i)),h=o.getter,!r&&h&&(n=h.apply(this,[n,t])),n=s(n)),n;a.warn("`getValue` called for an attribute that isn't defined",{topic:this.name,id:t,attr:i})}else a.warn("`getValue` called
                        for an id that doesn't exist in the registry.",{topic:this.name,id:t,attr:i});else a.warn("`getValue` requires two arguments.",{topic:this.name,id:t,attr:i})},setValue:function(t,r,n,o,h){var d,u,l,c,f,v,g;if(!t||!r||arguments.length
                        <3)a.warn(
                            "`setValue` requires three arguments.",{topic:this.name,id:t});else if(this.exists(t))if(d=this.attributes[r])if(d.readOnly)a.warn( "Attribute is readOnly.",{topic:this.name,id:t,attr:r});else if( "initOnly"!==d.writeOnce||o)if(!0===d.writeOnce&&this._data[t][r])a.warn(
                            "Attribute can only be set once.",{topic:this.name,id:t,attr:r});else{if(l=this.getValue(t,r),c=this._data[t][r],d.isListProxy&&(l=c),!h&&d.validator){if(v=d.validator,!e.Lang.isFunction(v))return void a.warn( "Attribute has an invalid validator.",{topic:this.name,validator:d.validator,attr:r});if(!v.apply(this,[n,t]))return
                            void a.info( "Attribute validation failed.",{topic:this.name,id:t,val:n,attr:r})}n=s(n),!h&&d.setter&&(n=d.setter.apply(this,[n,t])),d.isListProxy&&!e.Lang.isArray(n)&&(n=[]),d.isCollection&&(n? "object"==typeof n&&n instanceof
                            e.PagedCollection||(l?(c=l.getList(),l._setValue(n),n=l):(c=null,n=new e.PagedCollection(this,t,r,n))):n=new e.PagedCollection(this,t,r)),this._isDifferentValue(t,r,n,l)&&(!d.isModel||e.Lang.isObject(n)&&n.isModel?(o||(u=this._getAttributeValuesDerivedBy(t,r)),this._data[t][r]=n,d.isListProxy&&n&&(n.hasMinBoundary&&this.getValue(t,r).setMinBoundary(),n.hasMaxBoundary&&this.getValue(t,r).setMaxBoundary()),(d.isModel||d.isListProxy||d.isCollection)&&this._chainEvents(t,r),o||(f=this.getValue(t,r),d.isListProxy||d.isCollection||this._setUnsaved(t,r,f,l,c),g={id:t,attrName:r,prevVal:l,newVal:f},d.isListProxy?g.listDiff=this._calcListDiff(f,l):d.isCollection&&(g.listDiff=this._calcListDiff(f,c)),this._queueEvent(
                            "valuesChanged",g),e.Object.size(u)&&e.Object.each(u,function(e,s){var a=this.getValue(t,s);i(a,e)||(g={id:t,attrName:s,prevVal:e,newVal:a,derivedBy:[r]},(this.attributes[s].isListProxy||this.attributes[s].isCollection)&&(g.listDiff=this._calcListDiff(a,e)),this._queueEvent(
                            "valuesChanged",g))},this))):a.warn( "Attribute must be a ModelProxy instance.",{topic:this.name,id:t,attr:r}))}else a.warn( "Attribute can only be set during initialization.",{topic:this.name,id:t,attr:r});else a.warn(
                            "Attribute is not present in the attributes list.",{topic:this.name,id:t,attr:r});else a.warn( "`setValue called for an id that is not in the registry.",{topic:this.name,id:t})},setValues:function(t,i){var s={};e.Object.each(i,function(e,i){ "id"!==i&&(s[i]=this.setValue(t,i,e))},this)},revertValue:function(e,t){this._unsavedModels[e]&&void
                            0!==this._unsavedModels[e][t]&&this.setValue(e,t,this._unsavedModels[e][t].lastSavedValRaw)},exists:function(t){var i;return i=e.Lang.isArray(t)?t[0]:e.Lang.isObject(t,!0)?this.attributeSearch(t)[0]:t,!!this._data[i]},addOrUpdate:function(e){if(this.exists(e.id)){var
                            t,i;Object.keys(e).forEach(function(s){t=this.attributes[s],i=e[s],t&&!t.readOnly&& "initOnly"!==t.writeOnce&&this.setValue(e.id,s,i)},this)}else this.add(e);return this.appContext.markAsNewlyFetched(this.name,e.id),this.markChildModelsAsNewlyFetched(e.id),this.proxy(e.id)},markChildModelsAsNewlyFetched:function(e){var
                            t=this;this.getOwnedModels(e).forEach(function(e){e&&(t.appContext.markAsNewlyFetched(e.registry.name,e.id),e.markChildModelsAsNewlyFetched(e.id))})},getOwnedModels:function(t){var i,s,r,n=[];if(!t)return a.warn(
                            "`getOwnedModels` requires a model id.",{topic:this.name,id:t}),n;if(!this.exists(t))return n;this._ModelProxy||(this._ModelProxy=e.getModelProxyConstructor(this));for(i in this.attributes)(s=this.attributes[i]).isModel?(r=this.getValue(t,i))&&r.exists()&&n.push(r):(s.isListProxy||s.isCollection)&&(n=n.concat(this.getValue(t,i).getList().filter(function(e){return
                            e&&e.isModel&&e.exists()})));return n},hasAttribute:function(e){return!!this.attributes[e]},toJSON:function(e){var t,i,s={};if(e)for(t in this.attributes)s[t]=this.getValue(e,t),s[t]&&(this.attributes[t].isModel||this.attributes[t].isListProxy||this.attributes[t].isCollection)&&(s[t]=s[t].toJSON());else
                            for(i in this._data)s[i]=this.toJSON(i);return s},on:function(t,i,s,a){var r;return t||(t=null),r={eventName:i,fn:s,id:t,weak:a},this._subscribers.push(r),a&&(this.hasWeakSubscribers=!0),{detach:function(){var t=e.Array.indexOf(this._subscribers,r);this._subscribers.splice(t,1)}.bind(this)}},removeWeakSubscribers:function(){var
                            e=this._subscribers.length;if(e)for(;e--;)this._subscribers[e].weak&&this._subscribers.splice(e,1);this.hasWeakSubscribers=!1},getCount:function(){return this._dataSize},getDefaultValue:function(e,t){var i,s;return "function"==typeof(i=this.attributes[t]).defaultFn&&(s=i.defaultFn.call(this,e)),void
                            0===s&&void 0!==i.defaultValue&&(s=i.defaultValue),s},_isDifferentValue:function(e,t,s,a){var r=this.attributes[t],n=r.getter;if(n&&(s=n.apply(this,[s,e])),void 0!==r.isListProxy&&r.isListProxy&&void 0!==a){if(s.hasMaxBoundary!==(void
                            0!==a.hasMaxBoundary&&a.hasMaxBoundary)||s.hasMinBoundary!==(void 0!==a.hasMinBoundary&&a.hasMinBoundary))return!0}else if(r.isCollection)return!0;return!i(s,a)},_calcListDiff:function(t,i){var s,a,r,n,o={added:null,removed:null};return
                            s=t instanceof e.ListProxy||t instanceof e.PagedCollection?t.getList():t,a=i instanceof e.ListProxy||i instanceof e.PagedCollection?i.getList():i,r=a.reduce(function(e,t){return t&&t.id&&(e[t.id]=!0),e},{}),n=s.reduce(function(e,t){return
                            t&&t.id&&(e[t.id]=!0),e},{}),o.added=s.filter(function(e){return e&&!r[e.id]}),o.removed=a.filter(function(e){return e&&!n[e.id]}),o},_getAttributesDerivedBy:function(t){return this._derivedCache||(this._derivedCache={},e.Object.each(this.attributes,function(t,i){t.derivedBy&&e.Lang.isArray(t.derivedBy)&&e.Array.each(t.derivedBy,function(e){this._derivedCache[e]||(this._derivedCache[e]=[]),this._derivedCache[e].push(i)},this)},this)),this._derivedCache[t]},_getAttributeValuesDerivedBy:function(t,i){var
                            s=this._getAttributesDerivedBy(i),a={};return s&&s.length&&e.Array.each(s,function(e){a[e]=this.getValue(t,e)},this),a},_queueEvent:function(t,i){var s;this._eventQueue||(this._eventQueue=[]),(s=this._eventQueue).push({type:t,data:i}),this._eventPending||(this._eventPending=!0,setTimeout(function(){var
                            t={};this._eventPending=!1,delete this._eventQueue,e.Array.each(s,function(e){var i=e.type,s=e.data,a=s.id;switch(i){case "modelsAdded":case "modelsRemoved":t[i]=t[i]||{},t[i][a]=s;break;case "valuesChanged":if(t.valuesChanged&&t.valuesChanged[a]&&t.valuesChanged[a][s.attrName]&&t.valuesChanged[a][s.attrName].newVal){t.valuesChanged[a][s.attrName].newVal=s.newVal,t.valuesChanged[a][s.attrName].derivedBy&&s.derivedBy&&(t.valuesChanged[a][s.attrName].derivedBy=t.valuesChanged[a][s.attrName].derivedBy.concat(s.derivedBy)),t.valuesChanged[a][s.attrName].chained&&!s.chained&&delete
                            t.valuesChanged[a][s.attrName].chained;break}t.valuesChanged=t.valuesChanged||{},t.valuesChanged[a]=t.valuesChanged[a]||{},t.valuesChanged[a][s.attrName]=s}}),e.Object.each(t,function(e,t){this._fireEvent(t,e)},this)}.bind(this),0))},_fireEvent:function(t,i){e.Array.each(this._subscribers,function(e){e.eventName===t&&(e.id?i[e.id]&&e.fn.call(void
                            0,i[e.id]):e.fn.call(void 0,i))})},_chainEvents:function(t,i){var s,a,r=this.attributes[i];this._chainedEvents[t]=this._chainedEvents[t]||{},r.isModel?(this._chainedEvents[t][i]&&this._chainedEvents[t][i].detach(),a=this.getValue(t,i),this._chainedEvents[t][i]=a.on(
                            "valuesChanged",function(e){this._queueChainedEvent(t,i)}.bind(this))):(r.isListProxy||r.isCollection)&&(this._chainedEvents[t][i]&&e.Array.each(this._chainedEvents[t][i],function(e){e.detach()}),this._chainedEvents[t][i]=[],s=this.getValue(t,i),e.Array.each(s.getList(),function(e){e&&this._chainedEvents[t][i].push(e.on(
                            "valuesChanged",function(e){this._queueChainedEvent(t,i)}.bind(this)))},this))},_queueChainedEvent:function(t,i){var s,a=this.getValue(t,i);this._queueEvent( "valuesChanged",{id:t,attrName:i,prevVal:a,newVal:a,chained:!0}),s=this._getAttributeValuesDerivedBy(t,i),e.Object.size(s)&&e.Object.each(s,function(e,s){this._queueEvent(
                            "valuesChanged",{id:t,attrName:s,newVal:e,derivedBy:[i],chained:!0})},this)},_deleteUnsaved:function(t,i){this._unsavedModels[t]&&this._unsavedModels[t][i]&&(delete this._unsavedModels[t][i],0===e.Object.size(this._unsavedModels[t])&&delete
                            this._unsavedModels[t])},_setUnsaved:function(e,t,s,a,r){this._unsavedModels[e]&&this._unsavedModels[e][t]?i(s,this._unsavedModels[e][t].lastSavedVal)&&this._deleteUnsaved(e,t):(this._unsavedModels[e]=this._unsavedModels[e]||{},this._unsavedModels[e][t]={lastSavedVal:a,lastSavedValRaw:r})},_validateAttributes:function(){var
                            t,i;t=[ "setter", "getter", "validator", "defaultValue", "defaultFn", "derivedBy", "readOnly", "writeOnce", "isModel", "serialize", "deserialize"],i=[ "isListProxy", "isCollection", "pageFetch", "contextFetch", "rangeFetch"],e.Object.each(this.attributes,function(s,r){e.Object.each(s,function(n,o){s.isListProxy||s.isCollection?-1===e.Array.indexOf(i,o)&&a.warn(
                            "Unknown property on collection attribute.",{topic:this.name,prop:o,attr:r}):-1===e.Array.indexOf(t,o)&&a.warn( "Unknown property on attribute.",{topic:this.name,prop:o,attr:r})},this)},this)},_setDefaultRemoteMethods:function(){this.remote=this.remote||{},this.remote.create||(this.remote.create=function(t){return
                            a.error( "`remote.create` was called without being implemented.",{topic:this.name,attrs:t}),e.Promise.reject()}),this.remote.read||(this.remote.read=function(t){Object.keys(this.attributes).some(function(e){var t=this.attributes[e];if(!(
                            "id"===e||t.readOnly||t.isListProxy||t.isCollection||t.defaultValue||t.defaultFn))return!0},this), "object"!=typeof t&&(t={id:t});var i={id:t.id};return this.add(i),e.Promise.resolve(i)}),this.remote.update||(this.remote.update=function(t,i){return
                            a.error( "`remote.update` was called without being implemented.",{topic:this.name,id:t,attrs:i}),e.Promise.reject()}),this.remote.delete||(this.remote.delete=function(t){return a.error(
                            "`remote.delete` was called without being implemented.",{topic:this.name,id:t}),e.Promise.reject()})},remoteCreate:function(e){return this.remote.create.call(this,e)},remoteRead:function(e){return this.remote.read.call(this,e)},remoteUpdate:function(t){var i={},s=this;return this._unsavedModels[t]&&e.Object.each(this._unsavedModels[t],function(e,s){i[s]={newVal:this.getValue(t,s),prevVal:e.lastSavedVal}},this),e.Object.size(i)>0?this.remote.update.call(this,t,i).then(function(e){return s._unsavedModels={},e}):e.Promise.resolve()},remoteBatchUpdate:function(e,t){return this.remote.batchUpdate.call(this,e,t)},remoteDelete:function(e){var t=this;return
                            this.remote.delete.call(this,e).then(function(){t.remove(e)})},getListPageByContinuation:function(t,i){var s,a,r,n,o,h,d,u,l,c,f=this,v=f.appContext,g=e.APIHelper.request.getRebootPhotoExtras();switch(f.name){case"photo-groups-models":s="group-pool-models",a="groups",r="flickr.photos.getGroups",n="groups.group",g+=","+e.APIHelper.request.getRebootGroupExtras();break;case"photo-sets-models":s="set-models",a="sets",r="flickr.photos.getSets",n="sets.set";break;case"photo-galleries-models":s="gallery-models",a="galleries",r="flickr.photos.getGalleries",n="galleries.gallery"}return
                            r?f.exists(t)?(f.continuationKeys=f.continuationKeys||{},f.getMorePromises=f.getMorePromises||{},"-1"===(h=f.continuationKeys[t]||"0")?e.Promise.resolve({newItems:[],loadedAll:!0}):("0"===h&&(i+=f.getValue(t,a).getList().length),o={photo_id:t,extras:g,primary_photo_extras:"url_sq,
                            url_t, url_s, url_m",continuation:h,per_page:i},u=t+"_"+h,(l=f.getMorePromises[u])?l:(c={apiResponse:v.callAPI(r,o,!0),contextRegistry:v.getModelRegistry(s),personRegistry:v.getModelRegistry("person-models")},"photo-groups-models"===f.name&&(c.groupRegistry=v.getModelRegistry("group-models")),f.getMorePromises[u]=new
                            e.FlickrPromise(c).then(function(i){var s,r,o,h=[],l=i.apiResponse,c=i.contextRegistry,v=i.personRegistry,g=i.groupRegistry;return(r=n.split(".").reduce(function(t,i){return e.Lang.isObject(t)?t[i]:void 0},l))&&(e.Array.each(r,function(t){e.APIHelper.response.addContextToRegistry(t,c,v,g),h.push(c.proxy(t.id))}),h.length&&(o=f.getValue(t,a).getList().map(function(e){return
                            e.getValue("id")}),(h=h.filter(function(e){return-1===o.indexOf(e.getValue("id"))})).length&&f.getValue(t,a).appendToListMulti(h))),void 0===(d=l[a].continuation)?d="-1":e.Lang.isNumber(d)&&(d+=""),s="-1"===d,f.continuationKeys[t]=d,delete
                            f.getMorePromises[u],{newItems:h,loadedAll:s}},function(e){throw delete f.getMorePromises[u],e}),f.getMorePromises[u]))):e.Promise.reject("[api-helper] getListPageByContinuation was called for an ID that isn't in the registry:
                            "+t):e.Promise.reject("[api-helper] getListPageByContinuation was called without an invalid registry type: "+f.name)},getBuriedValue:function(e,t){var i,s={};return(i=this.getValue(e,t))&&i.payload&&(s=i.payload),s},setBuriedValue:function(e,t,i,s){return
                            this.setValue(e,t,{payload:i},s)}},e.mix(r.prototype,e.Localizable)},"@VERSION@",{requires:["flickr-promise","model-proxy","list-proxy","moment","paged-collection","localizable"]});YUI.add("hermes-lang-autosuggest",function(O,o){O.Intl.add("hermes/autosuggest","en-US",{MEMBER:["1
                            member"],MEMBERS:[{type:"number",valueName:"count"}," members"],SEARCH_PEOPLE:["Search people"],SEARCH_GROUPS:["Search groups"],SEARCH_PHOTOS:["Search photos"],MORE:["More"],MORE_SEARCH_TYPES:["More search types"],MORE_OPTIONS:["More
                            options"],SEARCH_YOUR_PHOTOS:["Search your photos"],SEARCH_EVERYONES_PHOTOS:["Search everyone's photos"],SEARCH_CONTACTS_PHOTOS:["Search your contacts' photos"],YOUR_PHOTOS:["Your photos"],EVERYONES_PHOTOS:["Everyone's photos"],YOUR_CONTACTS_PHOTOS:["Your
                            contacts' photos"],SEARCH_USER_PHOTOS:["Search ","${name}","'s photos"],SEARCH_GROUP_PHOTOS:["Search photos in ","${name}"],YOUR_PHOTOSTREAM:["Your photostream"],YOUR_ALBUMS:["Your albums"],SETS:["Sets"],CAMERA_ROLL:["Camera
                            roll"],ORGANIZE:["Organize"],YOUR_COLLECTIONS:["Your collections"],YOUR_GALLERIES:["Your galleries"],YOUR_ARCHIVES:["Your archives"],YOUR_TAGS:["Your tags"],YOUR_MAP:["Your map"],YOUR_FAVORITES:["Your favorites"],YOUR_STATS:["Your
                            stats"],GRAPHS:["Graphs"],REFERRERS:["Referrers"],VIEWS:["Views"],YOUR_APPS:["Your apps"],RECENT_ACTIVITY:["Recent activity"],PHOTOS_OF_YOU:["Photos of you"],UPLOAD_PHOTOS:["Upload photos"],YOUR_ACCOUNT:["Your account"],SETTINGS:["Settings"],PREFERENCES:["Preferences"],YOUR_PROFILE:["Your
                            profile"],FLICKR_MAIL:["Flickr mail"],ORGANIZR:["Organizr"],CREATE:["Create"],WALL_ART:["Wall art"],PHOTO_BOOKS:["Photo books"],CURATED_COLLECTION:["Curated collection"],PHOTOS_OF_YOUR_CONTACTS:["Photos of your contacts"],FOLLOWING:["Following"],CONTACTS_LIST:["Contacts
                            list"],FOLLOWERS:["Followers"],FIND_YOUR_FRIENDS:["Find your friends"],INVITE_YOUR_FRIENDS:["Invite your friends"],INVITE_HISTORY:["Invite history"],GUEST_PASS_HISTORY:["Guest pass history"],YOUR_GROUPS:["Your groups"],RECENT_GROUP_DISCUSSIONS:["Recent
                            group discussions"],CREATE_A_GROUP:["Create a group"],EXPLORE:["Explore"],POPULAR_TAGS:["Popular tags"],GALLERIES:["Galleries"],ANALOG:["Analog"],FILM:["Film"],WORLD_MAP:["World map"],PLACES:["Places"],THE_COMMONS:["The Commons"],CREATIVE_COMMONS:["Creative
                            Commons"],CC:["CC"],LICENSE:["License"],THE_FLICKR_BLOG:["The Flickr Blog"],THE_FLICKR_CODE_BLOG:["The Flickr Code Blog"],THE_APP_GARDEN:["The App Garden"],CAMERA_FINDER:["Camera finder"],DEVELOPER_GUIDE:["Developer guide"],API:["API"],PROGRAMMING:["Programming"],CODE:["Code"],DOCUMENTATION:["Documentation"],DEVELOPER:["Developer"],API_DOCUMENTATION:["API
                            documentation"],FEEDS:["Feeds"],RSS:["RSS"],ATOM:["Atom"],DATA:["Data"],HELP:["Help"],COMMUNITY_GUIDELINES:["Community guidelines"],HELP_FORUM:["Help forum"],FAQ:["FAQ"],FREQUENTLY_ASKED_QUESTIONS:["Frequently asked questions"],TOOLS:["Tools"],UPLOAD:["Upload"],MAC:["Mac"],WINDOWS:["Windows"],ABOUT_FLICKR:["About
                            Flickr"],STAFF:["Staff"],JOBS_AT_FLICKR:["Jobs at Flickr"],CAREER:["Career"],TWENTY_UNDER_TWENTY:["20 Under 20"],ME:["Me"],FLICKR_MARKETPLACE:["Flickr Marketplace"]})},"@VERSION@",{requires:["intl"]});