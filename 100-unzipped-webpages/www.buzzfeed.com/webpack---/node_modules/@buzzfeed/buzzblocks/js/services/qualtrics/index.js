import abeagle from '../abeagle';
import bzfd from '../bzfd';
import qualtricsSnippet from './snippet.html';

const FLAG_NAME = 'qualtrics_intercepts';

function insertQualtricsSnippet() {
    const renderedSnippet = qualtricsSnippet.render({
        editingVersion: (bzfd.isProd ? 'Q_VERSION=0&' : '')
    });
    document.body.insertAdjacentHTML('beforeend', renderedSnippet);
}

const service = {
    init() {
        abeagle.isOn(FLAG_NAME)
            .then((isOn) => {
                if (isOn) {
                    insertQualtricsSnippet();
                }
            });
    }
};

export default service;